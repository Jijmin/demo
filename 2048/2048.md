# 2048游戏制作
## 游戏架构
### 制作一个简单的游戏需要什么技术？
1. 游戏逻辑
2. 技术(HTML+CSS+Javascript+jQuery)
3. 美工
4. 创意
### 游戏架构
1. MVC架构
2. M->游戏数据
3. V->HTML+CSS搭建页面得到UI
4. C->js/jQuery控制游戏主逻辑
5. 用js/jQuery实现动画效果逻辑,主逻辑控制，显示给UI界面
6. 还有一个js的支撑逻辑控制数据与主逻辑的关系
### 文件夹结构
1. index.html---->2048主页面
2. style.css---->2048样式
3. main.js---->游戏主逻辑
4. animation.js---->动画效果逻辑
5. support.js---->底层支撑逻辑
### 构建页面元素
1. 编辑好页面的HTML+CSS样式，游戏主体的样式部分是一个大容器，里面的小格子根据外面的盒子进行绝对定位
2. 游戏主逻辑控制中只需要做一件事情，就是开始一个新的游戏
```
$(function(){
  //开始一个新的游戏
  newgame();
});
```
3. 初始化棋盘格
```
$(function(){
  //开始一个新的游戏
  newgame();
});
```
4. 双重循环对这16个格子的位置进行赋值
```
//初始化棋盘格
function init(){
  //双重循环对这16个格子的位置进行赋值
  for(var i=0;i<4;i++){//控制行
    for(j=0;j<4;j++){//控制列
    }
  }
}
```
5. 拿到坐标值对应的小格子元素，通过ID取得
```
var girdCell = $('#grid-cell-'+i+'-'+j);
```
6. 对每一个小格子的top和left进行计算
```
girdCell.css('top',getPosTop(i,j));
girdCell.css('left',getPosLeft(i,j));
```
7. top只与小盒子的行有关，left只与小格子的列有关
```
function getPosTop(i,j){
  return 20+i*120;
}
function getPosLeft(i,j){
  return 20+j*120;
}
```
### 游戏逻辑
1. 假设在初始的时候每一个girdCell的值是0，并不显示，当这些数字元素的值不为0时显示，数字与自己特殊的颜色属性以及显示的数字
2. 将数字的元素设置为number-cell
3. 在board二维数组总存储数字，number-cell是在前端相应的显示
4. 通过updateBoardView()通知前端二维数组的值发生改变，前端相应的显示也要发生改变
5. borad在初始化时被初始化为一个一维数组
```
var board=new Array();//游戏主要数据
```
6. 将board转换为二维数组
```
for(var i=0;i<4;i++){
  board[i]=new Array();
}
```
7. 初始化每一个board的值
```
for(var j=0;j<4;j++){
  board[i][j]=0;
}
```
8. board的更新函数
```
for(var i=0;i<4;i++){
  for(j=0;j<4;j++){
    //对每一个board元素生成number-cell
    $('#grid-container').append('<div class="number-cell" id="number-cell-'+i+'-'+j+'"></div>')
    var theNumberCell= $('number-cell-'+i+'-'+j);
    //number-cell的表现是不一样的
    if(board[i][j]===0){
      //不显示
      theNumberCell.css({
        width:'0px',
        height:'0px',
        top:getPosTop(i,j)+50,
        left:getPosLeft(i,j)+50
      });
    }else{
      theNumberCell.css({
        width:'100px',
        height:'100px',
        top:getPosTop(i,j),
        left:getPosLeft(i,j),
        //根据数字的不同，背景颜色相应改变
        backgroundColor:getNumberBackgroundColor(board[i][j]),
        color:getNumberColor(board[i][j])
      });
      //显示数组的值
      theNumberCell.text(board[i][j]);
    }
  }
}
```
9. getNumberBackgroundColor函数
```
function getNumberBackgroundColor(number){
  switch(number){
    case 2:return '#eee4de';break;
    case 4:return '#ede0c8';break;
    case 8:return '#f2b179';break;
    case 16:return '#f59563';break;
    case 32:return '#f67c5f';break;
    case 64:return '#f65e3b';break;
    case 128:return '#edcf72';break;
    case 256:return '#edcc61';break;
    case 512:return '#99cc00';break;
    case 1024:return '#33b5e5';break;
    case 2048:return '#0099cc';break;
    case 4096:return '#aa66cc';break;
    case 8192:return '#9933cc';break;
  }
  return 'black';
}
```
10. getNumberColor函数
```
function getNumberColor(number){
  if(number<=4){
    return '#ff6e65';
  }
  return 'white';
}
```